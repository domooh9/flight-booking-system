{"ast":null,"code":"\"use strict\";\n/* Copyright (c) 2020, VRAI Labs and/or its affiliates. All rights reserved.\n *\n * This software is licensed under the Apache License, Version 2.0 (the\n * \"License\") as published by the Apache Software Foundation.\n *\n * You may not use this file except in compliance with the License. You may\n * obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations\n * under the License.\n */\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    throw: verb(1),\n    return: verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BooleanClaim = exports.PrimitiveArrayClaim = exports.PrimitiveClaim = exports.SessionClaimValidator = exports.getInvalidClaimsFromResponse = exports.getClaimValue = exports.validateClaims = exports.signOut = exports.addAxiosInterceptors = exports.doesSessionExist = exports.attemptRefreshingSession = exports.getAccessToken = exports.getAccessTokenPayloadSecurely = exports.getUserId = exports.init = void 0;\n\nvar fetch_1 = require(\"./fetch\");\n\nvar recipeImplementation_1 = require(\"./recipeImplementation\");\n\nvar supertokens_js_override_1 = require(\"supertokens-js-override\");\n\nvar utils_1 = require(\"./utils\");\n\nvar cookieHandler_1 = require(\"./utils/cookieHandler\");\n\nvar windowHandler_1 = require(\"./utils/windowHandler\");\n\nvar lockFactory_1 = require(\"./utils/lockFactory\");\n\nvar sessionClaimValidatorStore_1 = require(\"./utils/sessionClaimValidatorStore\");\n\nvar AuthHttpRequest =\n/** @class */\nfunction () {\n  function AuthHttpRequest() {}\n\n  AuthHttpRequest.init = function (options) {\n    cookieHandler_1.default.init(options.cookieHandler);\n    windowHandler_1.default.init(options.windowHandler);\n    lockFactory_1.default.init(options.lockFactory);\n    var config = (0, utils_1.validateAndNormaliseInputOrThrowError)(options);\n    var recipeImpl = new supertokens_js_override_1.default((0, recipeImplementation_1.default)({\n      onHandleEvent: config.onHandleEvent,\n      preAPIHook: config.preAPIHook,\n      postAPIHook: config.postAPIHook,\n      sessionExpiredStatusCode: config.sessionExpiredStatusCode\n    })).override(config.override.functions).build();\n    fetch_1.default.init(config, recipeImpl);\n    AuthHttpRequest.axiosInterceptorQueue.forEach(function (f) {\n      f();\n    });\n    AuthHttpRequest.axiosInterceptorQueue = [];\n  };\n\n  AuthHttpRequest.getUserId = function (input) {\n    return fetch_1.default.recipeImpl.getUserId({\n      userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n    });\n  };\n\n  AuthHttpRequest.getAccessTokenPayloadSecurely = function (input) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_b) {\n        return [2\n        /*return*/\n        , fetch_1.default.recipeImpl.getAccessTokenPayloadSecurely({\n          userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n        })];\n      });\n    });\n  };\n\n  var _a;\n\n  _a = AuthHttpRequest;\n  AuthHttpRequest.axiosInterceptorQueue = [];\n\n  AuthHttpRequest.attemptRefreshingSession = function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(_a, function (_b) {\n        return [2\n        /*return*/\n        , fetch_1.default.attemptRefreshingSession()];\n      });\n    });\n  };\n\n  AuthHttpRequest.doesSessionExist = function (input) {\n    return fetch_1.default.recipeImpl.doesSessionExist({\n      userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n    });\n  };\n  /**\n   * @deprecated\n   */\n\n\n  AuthHttpRequest.addAxiosInterceptors = function (axiosInstance, userContext) {\n    if (!fetch_1.default.initCalled) {\n      // the recipe implementation has not been initialised yet, so add\n      // this to the queue and wait for it to be initialised, and then on\n      // init call, we add all the interceptors.\n      AuthHttpRequest.axiosInterceptorQueue.push(function () {\n        fetch_1.default.recipeImpl.addAxiosInterceptors({\n          axiosInstance: axiosInstance,\n          userContext: (0, utils_1.getNormalisedUserContext)(userContext)\n        });\n      });\n    } else {\n      fetch_1.default.recipeImpl.addAxiosInterceptors({\n        axiosInstance: axiosInstance,\n        userContext: (0, utils_1.getNormalisedUserContext)(userContext)\n      });\n    }\n  };\n\n  AuthHttpRequest.signOut = function (input) {\n    return fetch_1.default.recipeImpl.signOut({\n      userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n    });\n  };\n\n  AuthHttpRequest.getInvalidClaimsFromResponse = function (input) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_b) {\n        return [2\n        /*return*/\n        , fetch_1.default.recipeImpl.getInvalidClaimsFromResponse({\n          response: input.response,\n          userContext: (0, utils_1.getNormalisedUserContext)(input.userContext)\n        })];\n      });\n    });\n  };\n\n  AuthHttpRequest.getClaimValue = function (input) {\n    return __awaiter(this, void 0, void 0, function () {\n      var userContext, accessTokenPayload;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            userContext = (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext);\n            return [4\n            /*yield*/\n            , AuthHttpRequest.getAccessTokenPayloadSecurely({\n              userContext: userContext\n            })];\n\n          case 1:\n            accessTokenPayload = _b.sent();\n            return [2\n            /*return*/\n            , input.claim.getValueFromPayload(accessTokenPayload, userContext)];\n        }\n      });\n    });\n  };\n\n  AuthHttpRequest.validateClaims = function (overrideGlobalClaimValidators, userContext) {\n    var normalisedUserContext = (0, utils_1.getNormalisedUserContext)(userContext);\n    var claimValidatorsAddedByOtherRecipes = sessionClaimValidatorStore_1.SessionClaimValidatorStore.getClaimValidatorsAddedByOtherRecipes();\n    var globalClaimValidators = fetch_1.default.recipeImpl.getGlobalClaimValidators({\n      claimValidatorsAddedByOtherRecipes: claimValidatorsAddedByOtherRecipes,\n      userContext: normalisedUserContext\n    });\n    var claimValidators = overrideGlobalClaimValidators !== undefined ? overrideGlobalClaimValidators(globalClaimValidators, normalisedUserContext) : globalClaimValidators;\n\n    if (claimValidators.length === 0) {\n      return [];\n    }\n\n    return fetch_1.default.recipeImpl.validateClaims({\n      claimValidators: claimValidators,\n      userContext: (0, utils_1.getNormalisedUserContext)(userContext)\n    });\n  };\n\n  AuthHttpRequest.getAccessToken = function (input) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(_a, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , fetch_1.default.recipeImpl.doesSessionExist({\n              userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n            })];\n\n          case 1:\n            // This takes care of refreshing the access token if necessary.\n            if (_b.sent()) {\n              return [2\n              /*return*/\n              , (0, fetch_1.getTokenForHeaderAuth)(\"access\")];\n            }\n\n            return [2\n            /*return*/\n            , undefined];\n        }\n      });\n    });\n  };\n\n  return AuthHttpRequest;\n}();\n\nexports.default = AuthHttpRequest;\nexports.init = AuthHttpRequest.init;\nexports.getUserId = AuthHttpRequest.getUserId;\nexports.getAccessTokenPayloadSecurely = AuthHttpRequest.getAccessTokenPayloadSecurely;\nexports.getAccessToken = AuthHttpRequest.getAccessToken;\nexports.attemptRefreshingSession = AuthHttpRequest.attemptRefreshingSession;\nexports.doesSessionExist = AuthHttpRequest.doesSessionExist;\n/**\n * @deprecated\n */\n\nexports.addAxiosInterceptors = AuthHttpRequest.addAxiosInterceptors;\nexports.signOut = AuthHttpRequest.signOut;\nexports.validateClaims = AuthHttpRequest.validateClaims;\nexports.getClaimValue = AuthHttpRequest.getClaimValue;\nexports.getInvalidClaimsFromResponse = AuthHttpRequest.getInvalidClaimsFromResponse;\n\nvar types_1 = require(\"./types\");\n\nObject.defineProperty(exports, \"SessionClaimValidator\", {\n  enumerable: true,\n  get: function () {\n    return types_1.SessionClaimValidator;\n  }\n});\n\nvar primitiveClaim_1 = require(\"./claims/primitiveClaim\");\n\nObject.defineProperty(exports, \"PrimitiveClaim\", {\n  enumerable: true,\n  get: function () {\n    return primitiveClaim_1.PrimitiveClaim;\n  }\n});\n\nvar primitiveArrayClaim_1 = require(\"./claims/primitiveArrayClaim\");\n\nObject.defineProperty(exports, \"PrimitiveArrayClaim\", {\n  enumerable: true,\n  get: function () {\n    return primitiveArrayClaim_1.PrimitiveArrayClaim;\n  }\n});\n\nvar booleanClaim_1 = require(\"./claims/booleanClaim\");\n\nObject.defineProperty(exports, \"BooleanClaim\", {\n  enumerable: true,\n  get: function () {\n    return booleanClaim_1.BooleanClaim;\n  }\n});","map":{"version":3,"sources":["/home/dom/FlyM/node_modules/supertokens-website/lib/build/index.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","throw","return","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","Object","defineProperty","exports","BooleanClaim","PrimitiveArrayClaim","PrimitiveClaim","SessionClaimValidator","getInvalidClaimsFromResponse","getClaimValue","validateClaims","signOut","addAxiosInterceptors","doesSessionExist","attemptRefreshingSession","getAccessToken","getAccessTokenPayloadSecurely","getUserId","init","fetch_1","require","recipeImplementation_1","supertokens_js_override_1","utils_1","cookieHandler_1","windowHandler_1","lockFactory_1","sessionClaimValidatorStore_1","AuthHttpRequest","options","default","cookieHandler","windowHandler","lockFactory","config","validateAndNormaliseInputOrThrowError","recipeImpl","onHandleEvent","preAPIHook","postAPIHook","sessionExpiredStatusCode","override","functions","build","axiosInterceptorQueue","forEach","input","userContext","getNormalisedUserContext","undefined","_b","_a","axiosInstance","initCalled","response","accessTokenPayload","claim","getValueFromPayload","overrideGlobalClaimValidators","normalisedUserContext","claimValidatorsAddedByOtherRecipes","SessionClaimValidatorStore","getClaimValidatorsAddedByOtherRecipes","globalClaimValidators","getGlobalClaimValidators","claimValidators","getTokenForHeaderAuth","types_1","enumerable","get","primitiveClaim_1","primitiveArrayClaim_1","booleanClaim_1"],"mappings":"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","sourcesContent":["\"use strict\";\n/* Copyright (c) 2020, VRAI Labs and/or its affiliates. All rights reserved.\n *\n * This software is licensed under the Apache License, Version 2.0 (the\n * \"License\") as published by the Apache Software Foundation.\n *\n * You may not use this file except in compliance with the License. You may\n * obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations\n * under the License.\n */\nvar __awaiter =\n    (this && this.__awaiter) ||\n    function (thisArg, _arguments, P, generator) {\n        function adopt(value) {\n            return value instanceof P\n                ? value\n                : new P(function (resolve) {\n                      resolve(value);\n                  });\n        }\n        return new (P || (P = Promise))(function (resolve, reject) {\n            function fulfilled(value) {\n                try {\n                    step(generator.next(value));\n                } catch (e) {\n                    reject(e);\n                }\n            }\n            function rejected(value) {\n                try {\n                    step(generator[\"throw\"](value));\n                } catch (e) {\n                    reject(e);\n                }\n            }\n            function step(result) {\n                result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n            }\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\n        });\n    };\nvar __generator =\n    (this && this.__generator) ||\n    function (thisArg, body) {\n        var _ = {\n                label: 0,\n                sent: function () {\n                    if (t[0] & 1) throw t[1];\n                    return t[1];\n                },\n                trys: [],\n                ops: []\n            },\n            f,\n            y,\n            t,\n            g;\n        return (\n            (g = { next: verb(0), throw: verb(1), return: verb(2) }),\n            typeof Symbol === \"function\" &&\n                (g[Symbol.iterator] = function () {\n                    return this;\n                }),\n            g\n        );\n        function verb(n) {\n            return function (v) {\n                return step([n, v]);\n            };\n        }\n        function step(op) {\n            if (f) throw new TypeError(\"Generator is already executing.\");\n            while (_)\n                try {\n                    if (\n                        ((f = 1),\n                        y &&\n                            (t =\n                                op[0] & 2\n                                    ? y[\"return\"]\n                                    : op[0]\n                                    ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0)\n                                    : y.next) &&\n                            !(t = t.call(y, op[1])).done)\n                    )\n                        return t;\n                    if (((y = 0), t)) op = [op[0] & 2, t.value];\n                    switch (op[0]) {\n                        case 0:\n                        case 1:\n                            t = op;\n                            break;\n                        case 4:\n                            _.label++;\n                            return { value: op[1], done: false };\n                        case 5:\n                            _.label++;\n                            y = op[1];\n                            op = [0];\n                            continue;\n                        case 7:\n                            op = _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                        default:\n                            if (\n                                !((t = _.trys), (t = t.length > 0 && t[t.length - 1])) &&\n                                (op[0] === 6 || op[0] === 2)\n                            ) {\n                                _ = 0;\n                                continue;\n                            }\n                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {\n                                _.label = op[1];\n                                break;\n                            }\n                            if (op[0] === 6 && _.label < t[1]) {\n                                _.label = t[1];\n                                t = op;\n                                break;\n                            }\n                            if (t && _.label < t[2]) {\n                                _.label = t[2];\n                                _.ops.push(op);\n                                break;\n                            }\n                            if (t[2]) _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                    }\n                    op = body.call(thisArg, _);\n                } catch (e) {\n                    op = [6, e];\n                    y = 0;\n                } finally {\n                    f = t = 0;\n                }\n            if (op[0] & 5) throw op[1];\n            return { value: op[0] ? op[1] : void 0, done: true };\n        }\n    };\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BooleanClaim =\n    exports.PrimitiveArrayClaim =\n    exports.PrimitiveClaim =\n    exports.SessionClaimValidator =\n    exports.getInvalidClaimsFromResponse =\n    exports.getClaimValue =\n    exports.validateClaims =\n    exports.signOut =\n    exports.addAxiosInterceptors =\n    exports.doesSessionExist =\n    exports.attemptRefreshingSession =\n    exports.getAccessToken =\n    exports.getAccessTokenPayloadSecurely =\n    exports.getUserId =\n    exports.init =\n        void 0;\nvar fetch_1 = require(\"./fetch\");\nvar recipeImplementation_1 = require(\"./recipeImplementation\");\nvar supertokens_js_override_1 = require(\"supertokens-js-override\");\nvar utils_1 = require(\"./utils\");\nvar cookieHandler_1 = require(\"./utils/cookieHandler\");\nvar windowHandler_1 = require(\"./utils/windowHandler\");\nvar lockFactory_1 = require(\"./utils/lockFactory\");\nvar sessionClaimValidatorStore_1 = require(\"./utils/sessionClaimValidatorStore\");\nvar AuthHttpRequest = /** @class */ (function () {\n    function AuthHttpRequest() {}\n    AuthHttpRequest.init = function (options) {\n        cookieHandler_1.default.init(options.cookieHandler);\n        windowHandler_1.default.init(options.windowHandler);\n        lockFactory_1.default.init(options.lockFactory);\n        var config = (0, utils_1.validateAndNormaliseInputOrThrowError)(options);\n        var recipeImpl = new supertokens_js_override_1.default(\n            (0, recipeImplementation_1.default)({\n                onHandleEvent: config.onHandleEvent,\n                preAPIHook: config.preAPIHook,\n                postAPIHook: config.postAPIHook,\n                sessionExpiredStatusCode: config.sessionExpiredStatusCode\n            })\n        )\n            .override(config.override.functions)\n            .build();\n        fetch_1.default.init(config, recipeImpl);\n        AuthHttpRequest.axiosInterceptorQueue.forEach(function (f) {\n            f();\n        });\n        AuthHttpRequest.axiosInterceptorQueue = [];\n    };\n    AuthHttpRequest.getUserId = function (input) {\n        return fetch_1.default.recipeImpl.getUserId({\n            userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n        });\n    };\n    AuthHttpRequest.getAccessTokenPayloadSecurely = function (input) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                return [\n                    2 /*return*/,\n                    fetch_1.default.recipeImpl.getAccessTokenPayloadSecurely({\n                        userContext: (0, utils_1.getNormalisedUserContext)(\n                            input === undefined ? undefined : input.userContext\n                        )\n                    })\n                ];\n            });\n        });\n    };\n    var _a;\n    _a = AuthHttpRequest;\n    AuthHttpRequest.axiosInterceptorQueue = [];\n    AuthHttpRequest.attemptRefreshingSession = function () {\n        return __awaiter(void 0, void 0, void 0, function () {\n            return __generator(_a, function (_b) {\n                return [2 /*return*/, fetch_1.default.attemptRefreshingSession()];\n            });\n        });\n    };\n    AuthHttpRequest.doesSessionExist = function (input) {\n        return fetch_1.default.recipeImpl.doesSessionExist({\n            userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n        });\n    };\n    /**\n     * @deprecated\n     */\n    AuthHttpRequest.addAxiosInterceptors = function (axiosInstance, userContext) {\n        if (!fetch_1.default.initCalled) {\n            // the recipe implementation has not been initialised yet, so add\n            // this to the queue and wait for it to be initialised, and then on\n            // init call, we add all the interceptors.\n            AuthHttpRequest.axiosInterceptorQueue.push(function () {\n                fetch_1.default.recipeImpl.addAxiosInterceptors({\n                    axiosInstance: axiosInstance,\n                    userContext: (0, utils_1.getNormalisedUserContext)(userContext)\n                });\n            });\n        } else {\n            fetch_1.default.recipeImpl.addAxiosInterceptors({\n                axiosInstance: axiosInstance,\n                userContext: (0, utils_1.getNormalisedUserContext)(userContext)\n            });\n        }\n    };\n    AuthHttpRequest.signOut = function (input) {\n        return fetch_1.default.recipeImpl.signOut({\n            userContext: (0, utils_1.getNormalisedUserContext)(input === undefined ? undefined : input.userContext)\n        });\n    };\n    AuthHttpRequest.getInvalidClaimsFromResponse = function (input) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                return [\n                    2 /*return*/,\n                    fetch_1.default.recipeImpl.getInvalidClaimsFromResponse({\n                        response: input.response,\n                        userContext: (0, utils_1.getNormalisedUserContext)(input.userContext)\n                    })\n                ];\n            });\n        });\n    };\n    AuthHttpRequest.getClaimValue = function (input) {\n        return __awaiter(this, void 0, void 0, function () {\n            var userContext, accessTokenPayload;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        userContext = (0, utils_1.getNormalisedUserContext)(\n                            input === undefined ? undefined : input.userContext\n                        );\n                        return [\n                            4 /*yield*/,\n                            AuthHttpRequest.getAccessTokenPayloadSecurely({ userContext: userContext })\n                        ];\n                    case 1:\n                        accessTokenPayload = _b.sent();\n                        return [2 /*return*/, input.claim.getValueFromPayload(accessTokenPayload, userContext)];\n                }\n            });\n        });\n    };\n    AuthHttpRequest.validateClaims = function (overrideGlobalClaimValidators, userContext) {\n        var normalisedUserContext = (0, utils_1.getNormalisedUserContext)(userContext);\n        var claimValidatorsAddedByOtherRecipes =\n            sessionClaimValidatorStore_1.SessionClaimValidatorStore.getClaimValidatorsAddedByOtherRecipes();\n        var globalClaimValidators = fetch_1.default.recipeImpl.getGlobalClaimValidators({\n            claimValidatorsAddedByOtherRecipes: claimValidatorsAddedByOtherRecipes,\n            userContext: normalisedUserContext\n        });\n        var claimValidators =\n            overrideGlobalClaimValidators !== undefined\n                ? overrideGlobalClaimValidators(globalClaimValidators, normalisedUserContext)\n                : globalClaimValidators;\n        if (claimValidators.length === 0) {\n            return [];\n        }\n        return fetch_1.default.recipeImpl.validateClaims({\n            claimValidators: claimValidators,\n            userContext: (0, utils_1.getNormalisedUserContext)(userContext)\n        });\n    };\n    AuthHttpRequest.getAccessToken = function (input) {\n        return __awaiter(void 0, void 0, void 0, function () {\n            return __generator(_a, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        return [\n                            4 /*yield*/,\n                            fetch_1.default.recipeImpl.doesSessionExist({\n                                userContext: (0, utils_1.getNormalisedUserContext)(\n                                    input === undefined ? undefined : input.userContext\n                                )\n                            })\n                        ];\n                    case 1:\n                        // This takes care of refreshing the access token if necessary.\n                        if (_b.sent()) {\n                            return [2 /*return*/, (0, fetch_1.getTokenForHeaderAuth)(\"access\")];\n                        }\n                        return [2 /*return*/, undefined];\n                }\n            });\n        });\n    };\n    return AuthHttpRequest;\n})();\nexports.default = AuthHttpRequest;\nexports.init = AuthHttpRequest.init;\nexports.getUserId = AuthHttpRequest.getUserId;\nexports.getAccessTokenPayloadSecurely = AuthHttpRequest.getAccessTokenPayloadSecurely;\nexports.getAccessToken = AuthHttpRequest.getAccessToken;\nexports.attemptRefreshingSession = AuthHttpRequest.attemptRefreshingSession;\nexports.doesSessionExist = AuthHttpRequest.doesSessionExist;\n/**\n * @deprecated\n */\nexports.addAxiosInterceptors = AuthHttpRequest.addAxiosInterceptors;\nexports.signOut = AuthHttpRequest.signOut;\nexports.validateClaims = AuthHttpRequest.validateClaims;\nexports.getClaimValue = AuthHttpRequest.getClaimValue;\nexports.getInvalidClaimsFromResponse = AuthHttpRequest.getInvalidClaimsFromResponse;\nvar types_1 = require(\"./types\");\nObject.defineProperty(exports, \"SessionClaimValidator\", {\n    enumerable: true,\n    get: function () {\n        return types_1.SessionClaimValidator;\n    }\n});\nvar primitiveClaim_1 = require(\"./claims/primitiveClaim\");\nObject.defineProperty(exports, \"PrimitiveClaim\", {\n    enumerable: true,\n    get: function () {\n        return primitiveClaim_1.PrimitiveClaim;\n    }\n});\nvar primitiveArrayClaim_1 = require(\"./claims/primitiveArrayClaim\");\nObject.defineProperty(exports, \"PrimitiveArrayClaim\", {\n    enumerable: true,\n    get: function () {\n        return primitiveArrayClaim_1.PrimitiveArrayClaim;\n    }\n});\nvar booleanClaim_1 = require(\"./claims/booleanClaim\");\nObject.defineProperty(exports, \"BooleanClaim\", {\n    enumerable: true,\n    get: function () {\n        return booleanClaim_1.BooleanClaim;\n    }\n});\n"]},"metadata":{},"sourceType":"script"}